# SPECT PSF Model Comparison - Quick Test Configuration
# Faster settings for testing

# Data paths
data_path: "/home/storage/prepared_data/phantom_data/manc_nema_phantom_data/SPECT"

# SIMIND configuration
simind:
  config: "Discovery670.yaml"
  photon_energy: 81.5
  energy_lower: 36.84
  energy_upper: 126.16
  collimator: "ge-megp"
  source_type: "y90_frey"
  use_mpi: true
  num_mpi_cores: 6

# Resolution modeling
resolution:
  psf_fwhm: [6.91, 6.91, 6.91]
  stir_psf_params: [1.22, 0.031]

# Data fidelity
data_fidelity:
  eta_floor: 1.0e-5
  counts_floor: 1.0e-8

# Stochastic reconstruction parameters (reduced for testing)
stochastic:
  algorithm: SVRG
  num_subsets: 12
  num_epochs: 5
  initial_step_size: 0.1
  relaxation_eta: 0.02
  positivity_cap:
    enabled: true
    theta: 0.1

# RDP prior parameters (single beta for testing)
rdp:
  beta_values: [0.1]
  gamma: 1.0
  epsilon: 0.001
  stencil: 18
  both_directions: true
  boundary_condition: "Periodic"

# Preconditioning options
preconditioner:
  type: "poisson_hessian"  # Options: poisson_hessian, bsrem, both
  update_interval: 1
  poisson_hessian:
    mode: "ema"
    ema_decay: 0.9
    reset_interval: 12
    epsilon: 1.0e-8
    hessian_floor: 1.0e-12
    scale_to_full: true
  both:
    scales: [0.5, 0.5]
  prior:
    epsilon: 1.0e-8
    combine: "lehmer"
  lehmer:
    p: 0.1
    epsilon: 1.0e-8

# SimindProjector update control
projector:
  correction_update_epochs: 2

# Reconstruction selection (modes 1-2 only for quick test)
reconstruction:
  modes: [1, 2]

# Output options
output:
  save_intermediate: false
  verbose: true
  save_preconditioner: false
  preconditioner_interval: 12

# Cluster submission defaults
cluster:
  job_name: psf_mode_beta
  runtime: "02:00:00"
  memory: "16G"
  cores: 1
  queue: null
  gpu: false
  submit: false
  python_executable: python
  env_setup_script: null
  logs_subdir: logs
  job_script: project_psf/cluster/psf_sweep_job.sh
  qsub_extra_args: []
